<!DOCTYPE html>
<html>
    <head>
        <title>
            Alarm
        </title>
        <script src="https://coolprogramminguser.github.io/Standards/behavior.js"></script>
        <script>
            var countDown;
            var time;
            var sounds = [
                new Sound({"waveform":"sawtooth", "frequency":400}),
                new Sound({"waveform":"sawtooth", "frequency":420}),
                new Sound({"changeWave":"sawtooth", "modulation":.5, "hertzChange":150}),
                new Sound({"frequency":460, "changeWave":"sawtooth", "modulation":.5, "hertzChange":150})
                ];
            window.addEventListener("finished", function() {
                getId("start").addEventListener("click", function() {
                    if (this.innerHTML.trim() == "Start") {
                        this.innerHTML = "Renew";
                        getId("time").style.display = "none";
                        getId("time").value = getId("time").value.trim() ? Number(getId("time").value.trim())*60 : 900;
                        time = Number(getId("time").value);
                        getTag("h2")[0].innerHTML = "Seconds left: " + time;
                        document.title = "Alarm-time: " + time;
                        countDown = setInterval(function() {
                            if (time > 0 ) {
                                time--;
                                getTag("h2")[0].innerHTML = "Seconds left: " + time;
                                document.title = "Alarm-time: " + time;
                            } else {
                                time--;
                                sounds[0].start(.4);
                                sounds[1].start(.4);
                                setTimeout(function() {
                                    sounds[0].stop();
                                    sounds[1].stop();
                                }, 500);
                                if (time < -7 && !sounds[2].playing) {
                                    sounds[2].start();
                                    sounds[3].start();
                                }
                            }
                        }, 1000);
                    } else {
                        time = Number(getId("time").value);
                        getTag("h2")[0].innerHTML = "Seconds left: " + time;
                        document.title = "Alarm-time: " + time;
                    }
                });
                getId("stop").addEventListener("click", function() {
                    if (confirm("Are you sure you want to stop the alarm?")) {
                        clearInterval(countDown);
                        sounds.forEach(function(sound) {
                            sound.stop();
                        });
                        document.title = "Alarm";
                        getTag("h2")[0].innerHTML = "Seconds left: &infin;";
                        getId("time").value = "";
                        getId("time").style.display = "inline-block";
                        getId("start").innerHTML = "Start";
                    }
                });
            });
        </script>
    </head>
    <body>
        <h2>
            Seconds left: &infin;
        </h2>
        <input type="text" id="time" placeholder="Time to recur (minutes)">
        <br>
        <br>
        <button id="start">
            Start
        </button>
        <button id="stop">
            Stop
        </button>
    </body>
<html>
